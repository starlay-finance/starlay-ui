import dayjs, { Dayjs } from 'dayjs'
import { FC } from 'react'
import Countdown from 'react-countdown'
import { attention } from 'src/styles/colors'
import { fontWeightBold } from 'src/styles/font'
import { flexCenter } from 'src/styles/mixins'
import { formatWithTZ } from 'src/utils/date'
import { toLaunchpad } from 'src/utils/routes'
import styled from 'styled-components'

export type LaunchPadPopData = {
  id: string
  projectName: string
  token: {
    name: string
    symbol: string
  }
  sale: {
    start: Dayjs
    end: Dayjs
  }
}

const DATE_FORMAT = 'HH:mm z on MMM DD'

export const LaunchPadPopContent: FC<{ data: LaunchPadPopData }> = ({
  data: { id, projectName, token, sale },
}) => (
  <a href={toLaunchpad(id)} target="_blank" rel="noreferrer">
    <PopDiv>
      <Background />
      <Content>
        <p>{projectName}</p>
        <h1>{`${token.symbol} Token Sale`}</h1>
        <p>{`on Starlay Launchpad`}</p>
      </Content>
      <Schedule>
        {sale.start.isAfter(dayjs()) ? (
          `Sale start at ${formatWithTZ(sale.start, DATE_FORMAT)}`
        ) : (
          <>
            {`Remaining Time to Bid: `}
            <Countdown
              date={sale.end.toDate()}
              daysInHours
              renderer={({ formatted: { hours, minutes, seconds }, total }) => {
                const color =
                  total > 0 && total < 3600000 ? attention : undefined
                return (
                  <span style={{ color }}>
                    {hours}:{minutes}:{seconds}
                  </span>
                )
              }}
            />
          </>
        )}
      </Schedule>
    </PopDiv>
  </a>
)
const Background: FC = () => (
  <BackgroundDiv>
    <svg xmlns="http://www.w3.org/2000/svg" width="320" height="240">
      <defs>
        <linearGradient id="bg" y1="1" x2="1" y2="0">
          <stop offset="0" stopColor={skyBlue} />
          <stop offset="1" stopColor={darkRed} />
        </linearGradient>
        <mask id="cross">
          <rect width="320" height="240" fill="url(#bg)"></rect>
          <g transform="translate(-88 -88)">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="256"
              height="256"
              viewBox="0 0 150 150"
            >
              <path d="M24.059 59.534l-2.042-.986-2.974-1.436a.04.04 0 01.017-.077 10.613 10.613 0 009.334-5.779 52.26 52.26 0 0181.846-14.871c-12.323 25.379-19.38 38.423-29.091 41.81-10.262 3.578-24.9-3.126-53.2-16.782l-3.89-1.879zm33.1 64.633a9.713 9.713 0 016.405 8.378.041.041 0 00.079.013c7.827-17.168 11.123-27.6 8.383-35.459-3.57-10.24-17.875-17.528-46.061-31.15l-2.269-1.1a52.268 52.268 0 0033.457 59.318zm4.358 12.994a63.625 63.625 0 01-50.126-62.163q0-2.011.124-3.988a8.648 8.648 0 018.031-8.08.04.04 0 00.015-.077L2.845 54.781a75.009 75.009 0 0053.692 92.845q2.679-5.583 4.976-10.465zm-46.9-82.187a63.637 63.637 0 0190.6-35.967 13.787 13.787 0 017.211 12.692.039.039 0 00.075.021q.861-1.786 1.757-3.639l.986-2.042 5.143-10.65A74.936 74.936 0 004.353 50.015z" />
              <path d="M56.572 147.718l-.062-.015A75.081 75.081 0 012.766 54.764l.024-.09 16.8 8.113a.117.117 0 01-.043.223 8.6 8.6 0 00-7.96 8.006A63.78 63.78 0 0011.463 75a63.549 63.549 0 0050.066 62.087l.1.021-.041.088a1064.25 1064.25 0 01-4.984 10.465zM2.889 54.892a74.893 74.893 0 0053.6 92.64c2.07-4.3 3.589-7.493 4.913-10.318A63.614 63.614 0 0111.306 75c0-1.326.041-2.67.124-3.994a8.758 8.758 0 017.965-8.141zm60.714 77.771a.069.069 0 01-.021 0 .116.116 0 01-.1-.109 9.665 9.665 0 00-6.355-8.312 52.346 52.346 0 01-33.511-59.4l.019-.1 2.359 1.14c14.119 6.825 24.7 12.028 32.27 16.849 7.849 5 12.115 9.422 13.832 14.346 2.829 8.115-.932 19.169-8.385 35.517a.127.127 0 01-.108.069zm-39.852-67.7a52.477 52.477 0 00-.979 10.032 52.233 52.233 0 0034.409 49.094 9.823 9.823 0 016.445 8.306c9.767-21.447 10.448-29.179 8.321-35.275-1.7-4.888-5.951-9.289-13.768-14.267-7.566-4.817-18.139-10.018-32.253-16.84zm51.365 14.275c-9.872 0-23.695-6.415-47.2-17.755l-2.9-1.4-6.011-2.9a.117.117 0 01-.066-.131.116.116 0 01.116-.092 10.53 10.53 0 009.266-5.738 52.339 52.339 0 0181.97-14.894l.043.039-.024.053C97.719 62.352 90.738 74.933 81.173 78.269a18.193 18.193 0 01-6.057.969zm-51.02-19.772l1 .482 2.9 1.4c28.69 13.844 42.937 20.337 53.143 16.778 9.5-3.313 16.465-15.861 29.022-41.718a52.19 52.19 0 00-81.683 14.886 10.678 10.678 0 01-9.246 5.818zm-5.014-2.423zm-4.418-1.959l-.081-.038-10.33-4.988.024-.066A74.966 74.966 0 01120.436 15.33l.051.038-7.914 16.39a.113.113 0 01-.133.064.118.118 0 01-.09-.122 13.624 13.624 0 00-7.17-12.621 63.577 63.577 0 00-90.49 35.922zM4.449 49.978l10.125 4.89a63.715 63.715 0 0190.683-35.926 13.779 13.779 0 017.258 12.587l7.781-16.112a74.9 74.9 0 00-115.85 34.56z" />
              <path d="M149.921 74.998a74.574 74.574 0 01-11.425 39.777c-5.813-2.842-10.939-5.409-15.389-7.8a.039.039 0 01.019-.073 12.129 12.129 0 0010.618-7.463 63.656 63.656 0 00-14.558-70.192l5.139-10.641a74.742 74.742 0 0125.596 56.392zm-41.45 40.2a16.326 16.326 0 0110.5-3.765.042.042 0 00.015-.081c-12.895-5.434-21.4-7.448-28.066-5.126-6.574 2.293-11.935 9.019-18.533 20.993a52.376 52.376 0 0036.088-12.02zm16.739-1.121c-10.772 14.117-28.339 23.434-46.794 24.481a8 8 0 01-8.38-6.8.04.04 0 00-.075-.015c-2.565 4.9-5.346 10.547-8.457 16.96a75.03 75.03 0 0074.167-29.755q-5.617-2.67-10.457-4.87zm-5.837-66.763a19.414 19.414 0 01-2.8-12.656c-13.48 27.949-20.08 42.472-16.525 52.666 2.111 6.056 7.98 11.08 18.25 16.99a52.256 52.256 0 001.071-57z" />
              <path d="M75 150a75.729 75.729 0 01-13.506-1.215l-.1-.019.045-.092c2.766-5.7 5.706-11.7 8.456-16.962a.117.117 0 01.122-.062.122.122 0 01.1.1 7.9 7.9 0 008.3 6.729 64.765 64.765 0 0026.245-7.329 62.244 62.244 0 0020.486-17.124l.037-.049.056.026a578.998 578.998 0 0110.465 4.877l.084.039-.054.075a74.893 74.893 0 01-60.736 31zm-13.377-1.35a74.8 74.8 0 0073.935-29.667 578.968 578.968 0 00-10.32-4.811 62.416 62.416 0 01-20.505 17.114 64.931 64.931 0 01-26.309 7.348 8.297 8.297 0 01-.473.013 8.055 8.055 0 01-7.971-6.763c-2.72 5.206-5.621 11.129-8.356 16.766zm13.512-21.274q-1.373 0-2.745-.077l-.124-.008.06-.109a83.558 83.558 0 019.285-14.142c3.026-3.51 6.064-5.764 9.291-6.889 7.249-2.524 16.483.223 28.122 5.128a.12.12 0 01.073.135.117.117 0 01-.116.094h-.071a16.289 16.289 0 00-10.382 3.748l-.051-.06.051.06a52.822 52.822 0 01-33.393 12.119zm-2.612-.225a52.544 52.544 0 0035.9-12.012 16.452 16.452 0 0110.373-3.784c-11.528-4.847-20.678-7.553-27.846-5.055-6.083 2.126-11.427 8.166-18.427 20.85zm66.005-12.274l-.064-.03c-6.69-3.272-11.438-5.676-15.39-7.8a.113.113 0 01-.058-.127.119.119 0 01.113-.092 12.12 12.12 0 0010.549-7.416 63.472 63.472 0 00-14.541-70.106l-.041-.039 5.207-10.783.077.068a75.01 75.01 0 0114.187 96.266zm-15.257-7.9c3.915 2.1 8.614 4.478 15.2 7.7a74.783 74.783 0 00-14.115-95.94l-5.07 10.5a63.738 63.738 0 0114.534 70.239 12.278 12.278 0 01-10.553 7.499zm-.137.008zm-4.806-2.565l-.062-.036c-10.971-6.315-16.268-11.248-18.286-17.031-1.71-4.905-1.132-10.99 1.873-19.725 2.918-8.479 7.915-19.026 14.654-33l.148.043a19.418 19.418 0 002.784 12.608 52.336 52.336 0 01-1.073 57.084zm-1.875-69.319c-13.167 27.308-19.857 42.072-16.324 52.2 2 5.732 7.26 10.635 18.152 16.913a52.184 52.184 0 001.029-56.855 19.546 19.546 0 01-2.856-12.26z" />
            </svg>
          </g>
        </mask>
      </defs>
      <rect width="320" height="240" mask="url(#cross)" fill="url(#bg)"></rect>
    </svg>
  </BackgroundDiv>
)

const skyBlue = '#0AE2FF'
const darkRed = '#A40056'
const primary = '#FFFFFF'

const BackgroundDiv = styled.div``

const Schedule = styled.div`
  ${flexCenter};
  height: 50px;
  background-color: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(24px) brightness(1.08);
  white-space: pre-wrap;
`

const Content = styled.div`
  text-align: center;
  h1 {
    margin: 16px 0;
    font-size: 32px;
    font-weight: ${fontWeightBold};
    line-height: 1;
  }
`

const PopDiv = styled.div`
  width: 320px;
  height: 240px;
  position: relative;
  color: ${primary};
  ${BackgroundDiv} {
    position: absolute;
    inset: 0;
  }
  ${Content} {
    padding-top: 56px;
    position: relative;
  }
  ${Schedule} {
    position: absolute;
    bottom: 0;
    width: 100%;
  }
`
